###
# delim : %
# output : makefile
# help : my common makefile for tex projects
# vim: ft=make
###
SHELL = /bin/sh

.SUFFIXES:
.SUFFIXES: .pdf .tex

# portable except for these function calls
SRC = $(filter-out common.tex,$(wildcard *.tex))
PDF = $(SRC:tex=pdf)

LATEX = pdflatex
BIBTEX = biber
LATEXFLAGS = -halt-on-error

APP = Preview

all: $(PDF)

.tex.pdf:
	$(LATEX) $(LATEXFLAGS) $*
	$(BIBTEX) $(BIBTEXFLAGS) $*
	$(LATEX) $(LATEXFLAGS) $*
	$(LATEX) $(LATEXFLAGS) $*

interactive:
	@while read -r -p 'compile>'; do $(MAKE) preview; done

preview: $(PDF)
	open -a $(APP) $(PDF)

clean:
	git clean -fdx -e '*.sw*' -e '*.vim'
